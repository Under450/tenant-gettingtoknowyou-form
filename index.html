<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Getting to know you form</title>

  <style>
    :root{
      /* ===== BRAND / THEME ===== */
      --onyx: #0b0b0c;
      --cream: #F5F0E6;       /* brand cream */
      --cream-2: #FBF8F1;     /* lighter cream for cards/inputs */
      --text-dark: #111111;
      --text-mid: #444444;
      --accent: #d8c39a;      /* warm gold accent */
      --radius: 14px;
      --maxw: 760px;
    }

    body{
      margin:0; padding:24px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--cream);
      color: var(--text-dark);
      display:flex; justify-content:center;
    }

    .wrap{ width:100%; max-width:var(--maxw); }

    header{
      display:flex; align-items:center; gap:14px;
      margin-bottom:16px;
      padding: 12px 14px;
      background: var(--cream-2);
      border: 1px solid #00000010;
      border-radius: var(--radius);
    }
    header img{
      width:88px; height:88px; object-fit:contain;
      border-radius:8px;
      background: transparent;
      padding:0;
      display:block;
    }
    .logo-fallback{
      display:none;
      width:88px; height:88px;
      border:1px dashed #00000033;
      border-radius:8px;
      align-items:center; justify-content:center;
      font-size:12px; color:var(--text-mid);
      text-align:center; padding:6px; box-sizing:border-box;
    }

    h1{
      font-size:20px; margin:0;
      letter-spacing:0.2px;
    }
    .subtitle{
      color:var(--text-mid); font-size:14px; margin-top:4px;
    }

    .card{
      background: var(--cream-2);
      border: 1px solid #00000012;
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: 0 6px 18px #00000010;
    }

    .q{ margin: 14px 0; }

    label{
      font-weight: 650;
      display:block; margin-bottom:7px;
      font-size:15px;
    }

    select, input[type="email"], input[type="text"], input[type="date"]{
      width:100%;
      padding:12px;
      font-size:16px;
      border-radius:10px;
      border:1px solid #00000022;
      background:#ffffff;
      color:var(--text-dark);
      outline:none;
      box-sizing:border-box;
    }
    select:focus, input:focus{
      border-color: var(--accent);
      box-shadow: 0 0 0 3px #d8c39a44;
    }

    .hidden{ display:none; }

    .note{
      font-size:13px; color:var(--text-mid); margin-top:6px;
    }

    .endmsg{
      padding:12px; border-radius:10px;
      background:#ffffff;
      border:1px dashed #00000033;
      font-size:14px;
      line-height:1.4;
    }

    .btnrow{ margin-top:6px; display:flex; gap:10px; }

    button{
      padding:12px 16px; font-size:16px; cursor:pointer;
      border-radius:12px; border:0;
      background: linear-gradient(180deg, var(--accent), #bfa676);
      color:#111; font-weight:700;
      width:100%;
    }
    button[disabled]{ opacity:0.6; cursor:not-allowed; }

    .status{
      display:none; margin-top:10px; font-size:14px; color:var(--text-mid);
    }
    .status.show{ display:block; }

    /* Disclaimer block */
    .disclaimer{
      background:#ffffff;
      border:1px solid #00000018;
      border-radius:12px;
      padding:14px;
      margin-bottom:14px;
      font-size:14px;
      line-height:1.45;
    }
    .disclaimer strong{ font-weight:800; }
    .disclaimer ul{
      margin:8px 0 0 18px;
      padding:0;
    }
    .consent{
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin-top:10px;
    }
    .consent input{
      margin-top:3px;
      width:18px; height:18px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <!-- Logo: file must be in repo root.
           Use BergasonLogo.jpg if you renamed to remove the space. -->
      <img id="logoImg" src="BergasonLogo.jpg" alt="Bergason Property Services logo" />
      <div class="logo-fallback" id="logoFallback">Logo not found</div>

      <div>
        <h1>Getting to know you form</h1>
        <div class="subtitle">Please complete all questions. This will take less than ~ 2 minutes.</div>
      </div>
    </header>

    <div class="card">
      <form id="prescreenForm"
            action="https://formspree.io/f/mdkjvjvp"
            method="POST"
            novalidate>

        <input type="hidden" name="_subject" value="New Getting to know you form submission" />

        <!-- DISCLAIMER + REQUIRED CONSENT -->
        <div class="disclaimer">
          <strong>Disclaimer:-</strong> This form is designed to allow the Landlord to chose a suitable Tenant(s), without any form of discrimination. Filling out this form is completely anonymous, it will not ask for any questions that would identify or discriminate against you for any reason at all. If you do not wish to fill out this form, please let a member of staff know.
          <ul>
            <li>Disability (including physical or mental impairments)</li>
            <li>Gender reassignment</li>
            <li>Age</li>
            <li>Marriage and civil partnership status</li>
            <li>Pregnancy and maternity (including breastfeeding)</li>
            <li>Race (including colour, nationality, ethnic or national origins)</li>
            <li>Religion or belief (including a lack of belief)</li>
            <li>Sex (whether a person is male or female)</li>
            <li>Sexual orientation</li>
          </ul>
          Either directly or indirectly.
          <div class="consent">
            <input
              id="disclaimerConsent"
              name="Disclaimer consent"
              type="checkbox"
              required
            />
            <label for="disclaimerConsent" style="font-weight:600; margin:0;">
              I have read and understood the disclaimer above and I am happy to submit this form.
            </label>
          </div>
        </div>

        <!-- Q0 Email (mandatory) -->
        <div class="q">
          <label for="email">Your email address:</label>
          <input
            id="email"
            name="Your email address:"
            type="email"
            required
            autocomplete="email"
            inputmode="email"
            placeholder="name@example.com"
          />
        </div>

        <!-- Q: number of tenants (adults) -->
        <div class="q">
          <label for="adultsCount">How many tenants will be applying for this property?</label>
          <select id="adultsCount" name="How many tenants will be applying for this property?" required>
            <option value="" selected disabled>Select…</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>

        <!-- NEW: same family question (only appears if adults >= 3) -->
        <div class="q hidden" id="familyWrap">
          <label for="sameFamily">Are all applicants from the same family?</label>
          <select id="sameFamily" name="Are all applicants from the same family?">
            <option value="" selected disabled>Select…</option>
            <option>Yes</option>
            <option>No</option>
          </select>
        </div>

        <!-- Call office text (only if adults >= 3 AND sameFamily = No) -->
        <div class="q hidden" id="hmoWarning">
          <div class="endmsg">
            Please call our office as this amount of occupants could make this a House of Multiple Occupation, which it is not licenced for.
          </div>
        </div>

        <!-- Q: number of children -->
        <div class="q">
          <label for="childrenCount">How many children under the age of 18 will be living at the property?</label>
          <select id="childrenCount" name="How many children under the age of 18 will be living at the property?" required>
            <option value="" selected disabled>Select…</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>

        <!-- Everything after here can be blocked if HMO warning triggers -->
        <div id="restOfForm">

          <!-- Q1 Notice required -->
          <div class="q">
            <label for="noticeRequired">Do you have to give notice in your current property?</label>
            <select id="noticeRequired" name="Do you have to give notice in your current property?" required>
              <option value="" selected disabled>Select…</option>
              <option>Yes</option>
              <option>No</option>
            </select>
          </div>

          <!-- Q2 Notice length (conditional) -->
          <div class="q hidden" id="noticeLengthWrap">
            <label for="noticeLength">If so how long.</label>
            <select id="noticeLength" name="If so how long.">
              <option value="" selected disabled>Select…</option>
              <option>1 month</option>
              <option>2 months</option>
              <option>More than 2 months</option>
            </select>
          </div>

          <!-- Q3 Work -->
          <div class="q">
            <label for="workStatus">Do you and or your partner work?</label>
            <select id="workStatus" name="Do you and or your partner work?" required>
              <option value="" selected disabled>Select…</option>
              <option>Yes full time</option>
              <option>Yes part time</option>
              <option>No</option>
            </select>
          </div>

          <!-- Q4 Guarantor -->
          <div class="q">
            <label for="guarantor">If required can you provide a guarantor?</label>
            <select id="guarantor" name="If required can you provide a guarantor?" required>
              <option value="" selected disabled>Select…</option>
              <option>Yes</option>
              <option>No</option>
            </select>
          </div>

          <!-- Q4 Income 30x -->
          <div class="q">
            <label for="income30x">Does your household income cover 30 x the monthly rent?</label>
            <select id="income30x" name="Does your household income cover 30 x the monthly rent?" required>
              <option value="" selected disabled>Select…</option>
              <option>Yes</option>
              <option>No</option>
            </select>
          </div>

          <!-- Q5 Savings (conditional if income30x = No) -->
          <div class="q hidden" id="savingsWrap">
            <label for="savings">Do you have savings?</label>
            <select id="savings" name="Do you have savings?">
              <option value="" selected disabled>Select…</option>
              <option>Yes</option>
              <option>No</option>
            </select>
          </div>

          <!-- Q6 Move-in date -->
          <div class="q">
            <label for="moveInDate">If successful, when would you like to move into the property?</label>
            <input id="moveInDate" name="If successful, when would you like to move into the property?" type="date" required />
          </div>

          <!-- Q7 Right to rent -->
          <div class="q">
            <label for="rtr">Do you have the right to rent in the UK?</label>
            <select id="rtr" name="Do you have the right to rent in the UK?" required>
              <option value="" selected disabled>Select…</option>
              <option>Yes</option>
              <option>No</option>
            </select>
          </div>

          <!-- Share code (conditional if rtr = Yes) -->
          <div class="q hidden" id="shareCodeWrap">
            <label for="shareCode">If yes drop down what is your share code.</label>
            <input id="shareCode" name="If yes drop down what is your share code." type="text" />
            <div class="note">Paste your UK Right to Rent share code here.</div>
          </div>

          <!-- Cannot proceed message (conditional if rtr = No) -->
          <div class="q hidden" id="cannotProceed">
            <div class="endmsg">
              I am afraid we cannot progress your application any further as this is a legal requirement.
            </div>
          </div>

        </div><!-- /restOfForm -->

        <!-- Thank-you note (hidden until submit) -->
        <div class="q hidden" id="thankYouNote">
          <div class="endmsg">
            Thank you — your form has been submitted.<br>
            We’ll review your answers and contact you if you’re shortlisted.
          </div>
        </div>

        <div class="q btnrow">
          <button type="submit" id="submitBtn">Submit</button>
        </div>

        <div class="status" id="statusMsg">Submitting…</div>
      </form>
    </div>
  </div>

  <script>
    // Logo fallback if file not found
    const logoImg = document.getElementById('logoImg');
    const logoFallback = document.getElementById('logoFallback');
    logoImg.onerror = () => {
      logoImg.style.display = "none";
      logoFallback.style.display = "flex";
    };

    const form = document.getElementById('prescreenForm');

    const adultsCount = document.getElementById('adultsCount');
    const familyWrap = document.getElementById('familyWrap');
    const sameFamily = document.getElementById('sameFamily');
    const hmoWarning = document.getElementById('hmoWarning');
    const restOfForm = document.getElementById('restOfForm');

    const noticeRequired = document.getElementById('noticeRequired');
    const noticeLengthWrap = document.getElementById('noticeLengthWrap');
    const noticeLength = document.getElementById('noticeLength');

    const income30x = document.getElementById('income30x');
    const savingsWrap = document.getElementById('savingsWrap');
    const savings = document.getElementById('savings');

    const rtr = document.getElementById('rtr');
    const shareCodeWrap = document.getElementById('shareCodeWrap');
    const shareCode = document.getElementById('shareCode');
    const cannotProceed = document.getElementById('cannotProceed');

    const submitBtn = document.getElementById('submitBtn');
    const statusMsg = document.getElementById('statusMsg');
    const thankYouNote = document.getElementById('thankYouNote');

    function setRestEnabled(enabled){
      restOfForm.classList.toggle('hidden', !enabled);
      submitBtn.disabled = !enabled;
    }

    function updateAdultsLogic(){
      const n = parseInt(adultsCount.value, 10);

      if (!isNaN(n) && n >= 3) {
        // Ask family question first
        familyWrap.classList.remove('hidden');
        sameFamily.required = true;

        if (sameFamily.value === 'No') {
          // Not same family => show call office text and stop form
          hmoWarning.classList.remove('hidden');
          setRestEnabled(false);
        } else {
          // Same family or not chosen yet => allow continuation
          hmoWarning.classList.add('hidden');
          setRestEnabled(true);
        }
      } else {
        // Fewer than 3 tenants => no family question, no warning
        familyWrap.classList.add('hidden');
        hmoWarning.classList.add('hidden');
        sameFamily.required = false;
        sameFamily.value = '';
        setRestEnabled(true);
      }
    }

    adultsCount.addEventListener('change', updateAdultsLogic);
    sameFamily.addEventListener('change', updateAdultsLogic);

    // Notice branching
    noticeRequired.addEventListener('change', () => {
      if (noticeRequired.value === 'Yes') {
        noticeLengthWrap.classList.remove('hidden');
        noticeLength.required = true;
      } else {
        noticeLengthWrap.classList.add('hidden');
        noticeLength.required = false;
        noticeLength.value = '';
      }
    });

    // Income branching
    income30x.addEventListener('change', () => {
      if (income30x.value === 'No') {
        savingsWrap.classList.remove('hidden');
        savings.required = true;
      } else {
        savingsWrap.classList.add('hidden');
        savings.required = false;
        savings.value = '';
      }
    });

    // Right to rent branching
    rtr.addEventListener('change', () => {
      if (rtr.value === 'Yes') {
        shareCodeWrap.classList.remove('hidden');
        shareCode.required = true;
        cannotProceed.classList.add('hidden');
      } else if (rtr.value === 'No') {
        shareCodeWrap.classList.add('hidden');
        shareCode.required = false;
        shareCode.value = '';
        cannotProceed.classList.remove('hidden');
      }
    });

    // Submit + inline thank-you
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      submitBtn.disabled = true;
      statusMsg.textContent = "Submitting…";
      statusMsg.classList.add('show');

      try {
        const formData = new FormData(form);
        const res = await fetch(form.action, {
          method: "POST",
          body: formData,
          headers: { "Accept": "application/json" }
        });

        if (res.ok) {
          statusMsg.classList.remove('show');
          form.querySelectorAll('.q').forEach(q => q.classList.add('hidden'));
          document.querySelector('.disclaimer').classList.remove('hidden');
          thankYouNote.classList.remove('hidden');
        } else {
          submitBtn.disabled = false;
          statusMsg.textContent = "Submit failed. Please try again.";
        }
      } catch (err) {
        submitBtn.disabled = false;
        statusMsg.textContent = "Submit failed. Please try again.";
      }
    });
  </script>
</body>
</html>
